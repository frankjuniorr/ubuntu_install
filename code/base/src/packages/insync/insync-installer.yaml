---
# ============================================
# Add chave GPG
# ============================================
- name: "INSYNC | Add apt-key"
  become: yes
  apt_key:
    keyserver: "keyserver.ubuntu.com"
    id: "ACCAF35C"
    state: present
  register: "add_key_result"
  ignore_errors: True

- name: "INSYNC | Add apt-key"
  become: yes
  apt_key:
    keyserver: "hkp://keyserver.ubuntu.com:80"
    id: "ACCAF35C"
  when: add_key_result.failed

# ============================================
# Adicionando repositórios
# ============================================
- name: "INSYNC | add repository"
  become: yes
  apt_repository:
    repo: deb [arch=amd64] http://apt.insync.io/ubuntu {{ so_codename }} non-free contrib
    filename: insync
    state: present

# ============================================
# Atualizando repositórios
# ============================================
- name: "INSYNC | Update and upgrade apt packages"
  become: yes
  apt:
    upgrade: yes
    update_cache: yes

# ============================================
# Instalando o Insync
# ============================================
- name: "INSYNC | Install"
  become: yes
  become_method: sudo
  apt:
    name: "insync"
